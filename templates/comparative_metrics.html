<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MÃ©tricas Comparativas - Jira Sprints</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <nav class="blue darken-3">
        <div class="nav-wrapper container">
            <a href="/" class="brand-logo">Jira Sprints</a>
            <ul id="nav-mobile" class="right hide-on-med-and-down">
                <li><a href="/">Dashboard</a></li>
                <li><a href="/active">Sprint Activo</a></li>
                <li><a href="/metrics">MÃ©tricas</a></li>
                <li><a href="/comparative-metrics" class="active">MÃ©tricas Comparativas</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="row">
            <div class="col s12">
                <h4>MÃ©tricas Comparativas</h4>
                <p class="flow-text">AnÃ¡lisis detallado y comparativo de mÃºltiples sprints</p>
            </div>
        </div>

        <!-- Selector de Proyecto y Tablero -->
        <div class="row">
            <div class="col s12">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">SelecciÃ³n de Proyecto y Tablero</span>
                        <div class="row">
                            <div class="input-field col s12 m6">
                                <select id="project-select">
                                    <option value="" disabled selected>Selecciona un proyecto</option>
                                </select>
                                <label>Proyecto</label>
                            </div>
                            <div class="input-field col s12 m6">
                                <select id="board-select" disabled>
                                    <option value="" disabled selected>Selecciona un tablero</option>
                                </select>
                                <label>Tablero</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Selector de Sprints -->
        <div class="row" id="sprints-selection" style="display: none;">
            <div class="col s12">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">SelecciÃ³n de Sprints</span>
                        <p>Selecciona los sprints que deseas comparar (mÃ¡ximo 10):</p>
                        <div id="sprints-container" class="row">
                            <!-- Los sprints se cargarÃ¡n dinÃ¡micamente aquÃ­ -->
                        </div>
                        <div class="row">
                            <div class="col s12 right-align">
                                <button id="analyze-sprints" class="btn waves-effect waves-light blue" disabled>
                                    <i class="material-icons left">analytics</i>
                                    Analizar Sprints Seleccionados
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="row" id="analysis-progress" style="display: none;">
            <div class="col s12">
                <div class="progress">
                    <div class="indeterminate"></div>
                </div>
                <p class="center-align">Analizando sprints seleccionados...</p>
            </div>
        </div>

        <!-- Resumen Ejecutivo -->
        <div class="row" id="executive-summary" style="display: none;">
            <div class="col s12">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">ðŸ“‹ Resumen Ejecutivo</span>
                        <div id="insights-container">
                            <!-- Insights se cargarÃ¡n dinÃ¡micamente -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- MÃ©tricas de Equipo -->
        <div class="row" id="team-metrics" style="display: none;">
            <div class="col s12">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">ðŸ“Š MÃ©tricas de Equipo</span>
                        
                        <!-- Velocity y Productividad -->
                        <div class="row">
                            <div class="col s12 m6">
                                <div class="card-panel">
                                    <h6>Velocity y Productividad</h6>
                                    <canvas id="velocity-chart"></canvas>
                                </div>
                            </div>
                            <div class="col s12 m6">
                                <div class="card-panel">
                                    <h6>Eficiencia (Story Points/Hora)</h6>
                                    <canvas id="efficiency-chart"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- DistribuciÃ³n del Trabajo -->
                        <div class="row">
                            <div class="col s12 m6">
                                <div class="card-panel">
                                    <h6>DistribuciÃ³n por Tipo de Issue</h6>
                                    <canvas id="issue-distribution-chart"></canvas>
                                </div>
                            </div>
                            <div class="col s12 m6">
                                <div class="card-panel">
                                    <h6>Ratio Bugs vs Features</h6>
                                    <canvas id="bugs-ratio-chart"></canvas>
                                </div>
                            </div>
                            <div class="col s12 m6">
                                <div class="card-panel">
                                    <h6>Ratio Support vs Features</h6>
                                    <canvas id="support-ratio-chart"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Calidad de Estimaciones -->
                        <div class="row">
                            <div class="col s12">
                                <div class="card-panel">
                                    <h6>Calidad de Estimaciones</h6>
                                    <canvas id="estimation-quality-chart"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Tabla de MÃ©tricas Comparativas -->
                        <div class="row">
                            <div class="col s12">
                                <div class="card-panel">
                                    <h6>MÃ©tricas Comparativas por Sprint</h6>
                                    <div id="team-metrics-table"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- MÃ©tricas Individuales -->
        <div class="row" id="individual-metrics" style="display: none;">
            <div class="col s12">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">ðŸ‘¤ MÃ©tricas Individuales</span>
                        
                        <!-- Productividad Individual -->
                        <div class="row">
                            <div class="col s12 m6">
                                <div class="card-panel">
                                    <h6>Story Points por Desarrollador</h6>
                                    <canvas id="individual-velocity-chart"></canvas>
                                </div>
                            </div>
                            <div class="col s12 m6">
                                <div class="card-panel">
                                    <h6>Horas Trabajadas por Persona</h6>
                                    <canvas id="individual-hours-chart"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- EspecializaciÃ³n -->
                        <div class="row">
                            <div class="col s12">
                                <div class="card-panel">
                                    <h6>DistribuciÃ³n de Trabajo por Persona</h6>
                                    <canvas id="specialization-chart"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Tabla de MÃ©tricas Individuales -->
                        <div class="row">
                            <div class="col s12">
                                <div class="card-panel">
                                    <h6>Ranking de Productividad Individual</h6>
                                    <div id="individual-metrics-table"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AnÃ¡lisis de Tendencias -->
        <div class="row" id="trends-analysis" style="display: none;">
            <div class="col s12">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">ðŸ“ˆ AnÃ¡lisis de Tendencias</span>
                        
                        <!-- Tendencias Temporales -->
                        <div class="row">
                            <div class="col s12 m6">
                                <div class="card-panel">
                                    <h6>EvoluciÃ³n de Velocity</h6>
                                    <canvas id="velocity-trend-chart"></canvas>
                                </div>
                            </div>
                            <div class="col s12 m6">
                                <div class="card-panel">
                                    <h6>PrecisiÃ³n de Estimaciones en el Tiempo</h6>
                                    <canvas id="estimation-trend-chart"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Patrones de Trabajo -->
                        <div class="row">
                            <div class="col s12">
                                <div class="card-panel">
                                    <h6>Consistencia en Estimaciones</h6>
                                    <canvas id="consistency-chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recomendaciones -->
        <div class="row" id="recommendations" style="display: none;">
            <div class="col s12">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">ðŸ’¡ Recomendaciones AutomÃ¡ticas</span>
                        <div id="recommendations-container">
                            <!-- Recomendaciones se cargarÃ¡n dinÃ¡micamente -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Botones de Descarga -->
        <div class="row" id="download-section" style="display: none;">
            <div class="col s12">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">Descargar AnÃ¡lisis</span>
                        <div class="row">
                            <div class="col s12 right-align">
                                <button id="download-comparative-xlsx" class="btn waves-effect waves-light blue">
                                    <i class="material-icons left">file_download</i>
                                    Descargar Excel
                                </button>
                                <button id="download-comparative-csv" class="btn waves-effect waves-light green">
                                    <i class="material-icons left">file_download</i>
                                    Descargar CSV
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="{{ url_for('static', filename='js/comparative_metrics.js') }}"></script>
</body>
</html> 